// Copyright (c) 2012-2014, Michael Bostock
// All rights reserved.
(function(){d3.hexbin=function(){function l(e){var t={};e.forEach(function(e,n){var r=u.call(l,e,n)/f,i=Math.round(r),s=o.call(l,e,n)/a-(i&1?.5:0),c=Math.round(s),h=r-i;if(Math.abs(h)*3>1){var p=s-c,d=c+(s<c?-1:1)/2,v=i+(r<i?-1:1),m=s-d,g=r-v;if(p*p+h*h>m*m+g*g)c=d+(i&1?1:-1)/2,i=v}var b=c+"-"+i,w=t[b];if(w)w.push(e);else{w=t[b]=[e];w.i=c;w.j=i;w.x=(c+(i&1?1/2:0))*a;w.y=i*f}});return d3.values(t)}function c(t){var n=0,r=0;return e.map(function(e){var i=Math.sin(e)*t,s=-Math.cos(e)*t,o=i-n,u=s-r;n=i,r=s;return[o,u]})}var r=1,i=1,s,o=t,u=n,a,f;l.x=function(e){if(!arguments.length)return o;o=e;return l};l.y=function(e){if(!arguments.length)return u;u=e;return l};l.hexagon=function(e){if(arguments.length<1)e=s;return"m"+c(e).join("l")+"z"};l.centers=function(){var e=[];for(var t=0,n=false,o=0;t<i+s;t+=f,n=!n,++o){for(var u=n?a/2:0,l=0;u<r+a/2;u+=a,++l){var c=[u,t];c.i=l;c.j=o;e.push(c)}}return e};l.mesh=function(){var e=c(s).slice(0,4).join("l");return l.centers().map(function(t){return"M"+t+"m"+e}).join("")};l.size=function(e){if(!arguments.length)return[r,i];r=+e[0],i=+e[1];return l};l.radius=function(e){if(!arguments.length)return s;s=+e;a=s*2*Math.sin(Math.PI/3);f=s*1.5;return l};return l.radius(1)};var e=d3.range(0,2*Math.PI,Math.PI/3),t=function(e){return e.x},n=function(e){return e.y}})()